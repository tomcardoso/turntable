{"version":3,"file":null,"sources":["../lib/loadJS.js","../lib/loadCSS.js","../plugins/chart-tool/index.js","../plugins/jquery/index.js","../plugins/bootstrap/index.js","../plugins/export.js","../src/load.js","../src/index.js"],"sourcesContent":["/*! loadJS: load a JS file asynchronously. [c]2014 @scottjehl, Filament Group, Inc. (Based on http://goo.gl/REQGQ by Paul Irish). Licensed MIT */\nexport default function loadJS(src, cb) {\n  \"use strict\";\n  var ref = window.document.getElementsByTagName(\"script\")[0];\n  var script = window.document.createElement(\"script\");\n  script.src = src;\n  script.async = true;\n  ref.parentNode.insertBefore(script, ref);\n  if (cb && typeof(cb) === \"function\") {\n    script.onload = cb;\n  }\n  return script;\n}\n","/*! loadCSS: load a CSS file asynchronously. [c]2016 @scottjehl, Filament Group, Inc. Licensed MIT */\nexport function loadCSS(href, before, media) {\n  // Arguments explained:\n  // `href` [REQUIRED] is the URL for your CSS file.\n  // `before` [OPTIONAL] is the element the script should use as a reference for injecting our stylesheet <link> before\n  // By default, loadCSS attempts to inject the link after the last stylesheet or script in the DOM. However, you might desire a more specific location in your document.\n  // `media` [OPTIONAL] is the media type or query of the stylesheet. By default it will be 'all'\n  var doc = window.document;\n  var ss = doc.createElement(\"link\");\n  var ref;\n  if (before) {\n    ref = before;\n  } else {\n    var refs = (doc.body || doc.getElementsByTagName(\"head\")[0]).childNodes;\n    ref = refs[refs.length - 1];\n  }\n\n  var sheets = doc.styleSheets;\n  ss.rel = \"stylesheet\";\n  ss.href = href;\n  // temporarily set media to something inapplicable to ensure it'll fetch without blocking render\n  ss.media = \"only x\";\n\n  // wait until body is defined before injecting link. This ensures a non-blocking load in IE11.\n  function ready(cb) {\n    if (doc.body) {\n      return cb();\n    }\n    setTimeout(function() {\n      ready(cb);\n    });\n  }\n  // Inject link\n  // Note: the ternary preserves the existing behavior of \"before\" argument, but we could choose to change the argument to \"after\" in a later release and standardize on ref.nextSibling for all refs\n  // Note: `insertBefore` is used instead of `appendChild`, for safety re: http://www.paulirish.com/2011/surefire-dom-element-insertion/\n  ready(function() {\n    ref.parentNode.insertBefore(ss, (before ? ref : ref.nextSibling));\n  });\n  // A method (exposed on return object for external use) that mimics onload by polling document.styleSheets until it includes the new sheet.\n  var onloadcssdefined = function(cb) {\n    var resolvedHref = ss.href;\n    var i = sheets.length;\n    while (i--) {\n      if (sheets[i].href === resolvedHref) {\n        return cb();\n      }\n    }\n    setTimeout(function() {\n      onloadcssdefined(cb);\n    });\n  };\n\n  function loadCB() {\n    if (ss.addEventListener) {\n      ss.removeEventListener(\"load\", loadCB);\n    }\n    ss.media = media || \"all\";\n  }\n\n  // once loaded, set link's media back to `all` so that the stylesheet applies once it loads\n  if (ss.addEventListener) {\n    ss.addEventListener(\"load\", loadCB);\n  }\n  ss.onloadcssdefined = onloadcssdefined;\n  onloadcssdefined(loadCB);\n  return ss;\n}\n\n/*! onloadCSS: adds onload support for asynchronous stylesheets loaded with loadCSS. [c]2016 @zachleat, Filament Group, Inc. Licensed MIT */\nexport function onloadCSS(ss, callback) {\n  var called;\n\n  function newcb() {\n    if (!called && callback) {\n      called = true;\n      callback.call(ss);\n    }\n  }\n  if (ss.addEventListener) {\n    ss.addEventListener(\"load\", newcb);\n  }\n  if (ss.attachEvent) {\n    ss.attachEvent(\"onload\", newcb);\n  }\n\n  // This code is for browsers that donâ€™t support onload\n  // No support for onload (it'll bind but never fire):\n  //\t* Android 4.3 (Samsung Galaxy S4, Browserstack)\n  //\t* Android 4.2 Browser (Samsung Galaxy SIII Mini GT-I8200L)\n  //\t* Android 2.3 (Pantech Burst P9070)\n\n  // Weak inference targets Android < 4.4\n  if (\"isApplicationInstalled\" in navigator && \"onloadcssdefined\" in ss) {\n    ss.onloadcssdefined(newcb);\n  }\n}\n","import plugin from \"./plugin.json\";\n\nexport default function() {\n\n  // some basic logic about how to decide which version to load\n\n  if (!plugin.versions) {\n    return null;\n  }\n\n  const pluginObj = {\n    name: plugin.name,\n    basepath: plugin.basepath,\n    priority: plugin.priority\n  };\n\n  const charts = window.__charttool;\n\n  if (charts) {\n\n    // find most common version and load that\n    let j = charts.length;\n\n    const versions = [];\n\n    while (j--) {\n      versions.push(charts[j].data.version);\n    }\n\n    pluginObj.assets = plugin.versions[mode(versions.sort())];\n\n  } else {\n\n    // using 1.0.2\n    pluginObj.assets = plugin.versions[\"1.0.2\"];\n\n  }\n\n  return pluginObj;\n\n}\n\n// taken from http://stackoverflow.com/a/1053865/602748\nfunction mode(array) {\n\n  let l = array.length;\n\n  if (l === 0) {\n    return null;\n  }\n\n  const modeMap = {};\n\n  let maxEl = array[0],\n    maxCount = 1;\n\n  while (l--) {\n\n    let el = array[l];\n\n    if (modeMap[el] == null) {\n      modeMap[el] = 1;\n    } else {\n      modeMap[el]++;\n    }\n\n    if (modeMap[el] > maxCount) {\n      maxEl = el;\n      maxCount = modeMap[el];\n    }\n\n  }\n\n  return maxEl;\n\n}\n","import plugin from \"./plugin.json\";\n\nexport default function() {\n\n  if (!plugin.versions) {\n    return null;\n  }\n\n  return {\n    name: plugin.name,\n    basepath: plugin.basepath,\n    priority: plugin.priority,\n    assets: plugin.versions[Object.keys(plugin.versions)[0]]\n  };\n\n}\n","import plugin from \"./plugin.json\";\n\nexport default function() {\n\n  if (!plugin.versions) {\n    return null;\n  }\n\n  return {\n    name: plugin.name,\n    basepath: plugin.basepath,\n    priority: plugin.priority,\n    assets: plugin.versions[Object.keys(plugin.versions)[0]]\n  };\n\n}\n","import charttool from './chart-tool/index';\nimport jquery from './jquery/index';\nimport bootstrap from './bootstrap/index';\n\nconst exports = [\n  charttool(),\n  jquery(),\n  bootstrap()\n];\n\n// might be unnecessary if we just take the implicit order from up above\n// exports.sort(function(a, b) {\n//   return a.priority - b.priority;\n// });\n\nexport default (function() {\n  return exports;\n})();\n","// export function load() {\n//   // if \"HEAD\" is declared, load via XHR synchronously\n//   // if not, defer rest of loading to bottom of page\n//   // build dependency tree and\n// }\n//\n// function loadSync(path, cb) {\n//\n//   // ideas borrowed from http://stackoverflow.com/questions/2879509/dynamically-loading-javascript-synchronously\n//\n//   // let xhrObj = new XMLHttpRequest();\n//   // xhrObj.open('GET', path, false);\n//   // xhrObj.send(null);\n//   // eval(xhrObj.responseText);\n//\n//   let s = document.createElement('script');\n//   s.type = \"text/javascript\";\n//   s.src = path;\n//   if (cb) {\n//     s.onload = cb;\n//     tag.onreadystatechange = cb; // for IE8\n//   }\n//\n//   document.body.appendChild(s);\n// }\n//\n// function getScript(src, callback) {\n//   var s = document.createElement('script');\n//   s.src = src;\n//   s.async = true;\n//   s.onreadystatechange = s.onload = function() {\n//     if (!callback.done && (!s.readyState || /loaded|complete/.test(s.readyState))) {\n//       callback.done = true;\n//       callback();\n//     }\n//   };\n//   document.querySelector('head').appendChild(s);\n// }\n//\n\n\nexport function loadSync(scripts, basepath, cb) {\n\n  const loadScript = function(src) {\n    let xmlhttp, next;\n    if (window.XMLHttpRequest) {\n      xmlhttp = new XMLHttpRequest();\n    } else {\n      try {\n        xmlhttp = new ActiveXObject(\"Microsoft.XMLHTTP\");\n      } catch (e) {\n        return;\n      }\n    };\n\n    xmlhttp.onreadystatechange = function() {\n      if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {\n        let fn = new Function(xmlhttp.responseText);\n        fn();\n        next = scripts.shift();\n        if (next) {\n          loadScript(next);\n        } else if (typeof cb == 'function') {\n          cb();\n        }\n      }\n    }\n    xmlhttp.open(\"GET\", basepath + src, true);\n    xmlhttp.send();\n  };\n\n  loadScript(scripts.shift());\n}\n\n\n// function loadScripts(uris, whenDone) {\n//   if (!uris.length) whenDone && whenDone();\n//   else {\n//     for (var wait = [], i = uris.length; i--;) {\n//       var tag = document.createElement('script');\n//       tag.type = 'text/javascript';\n//       tag.src = uris[i];\n//       if (whenDone) {\n//         wait.push(tag)\n//         tag.onload = maybeDone;\n//         tag.onreadystatechange = maybeDone; // For IE8-\n//       }\n//       document.body.appendChild(tag);\n//     }\n//   }\n//\n//   function maybeDone() {\n//     if (this.readyState === undefined || this.readyState === 'complete') {\n//       // Pull the tags out based on the actual element in case IE ever\n//       // intermingles the onload and onreadystatechange handlers for the same\n//       // script block before notifying for another one.\n//       for (var i = wait.length; i--;)\n//         if (wait[i] == this) wait.splice(i, 1);\n//       if (!wait.length) whenDone();\n//     }\n//   }\n// }\n","import scripts from '../lib/loadJS';\nimport * as styles from '../lib/loadCSS';\nimport deps from '../plugins/export';\nimport { loadSync } from './load'\n\nexport default (function() {\n\n  const turntable = window.__turntable = window.__turntable || {\n    deps: deps,\n    loaded: []\n  };\n\n  var d = deps.length;\n\n  const headers = [];\n\n  while (d--) {\n    if (deps[d].assets.header && deps[d].assets.header.length) {\n      headers.push({\n        name: deps[d].name,\n        basepath: deps[d].basepath,\n        assets: deps[d].assets.header\n      });\n    }\n  }\n\n  if (headers.length) {\n    loadHeaders(headers, function() {\n      console.log(\"headers loaded!\");\n    });\n  }\n\n  // for (var i = 0; i < deps.length; i++) {\n  //   loadDep(deps[i]);\n  // }\n\n})();\n\nfunction resolve(basepath, file) {\n\n}\n\nfunction loadHeaders(headers, cb) {\n  let h = headers.length;\n  let counter = 0;\n  while (h--) {\n    loadDep(headers[h], loadSync, function() {\n      counter++;\n      if (counter === headers.length) {\n        cb();\n      }\n    });\n  }\n}\n\n// function loadSync(param, cb) {\n//   console.log(param);\n// }\n\nfunction loadDeps(deps) {\n  for (var i = 0; i < deps.length; i++) {\n    loadDep(deps[i]);\n  }\n}\n\nfunction loadDep(dep, loadFn, cb) {\n  // console.log(dep.assets);\n\n  loadFn(dep.assets, dep.basepath);\n  // if (headers.length) {\n  //   loadHeaders(headers.reverse(), function() {\n  //     loadLoop(deps);\n  //   });\n}\n\nfunction getAssets(dep) {\n\n  // console.log(dep);\n  // console.log(scripts);\n  // need to get basepath\n  // start by resolving and loading header files\n  // for footer files, write them afterwards by using a dom event trigger for onload\n  // when onload fires, resolve their load order, then load the remaining files\n\n  // debugger;\n\n}\n"],"names":["plugin","versions","pluginObj","name","basepath","priority","charts","window","__charttool","j","length","push","data","version","assets","mode","sort","array","l","modeMap","maxEl","maxCount","el","Object","keys","exports","charttool","jquery","bootstrap","loadSync","scripts","cb","loadScript","src","xmlhttp","next","XMLHttpRequest","ActiveXObject","e","onreadystatechange","readyState","status","fn","Function","responseText","shift","open","send","turntable","__turntable","deps","d","headers","header","log","loadHeaders","h","counter","loadDep","dep","loadFn"],"mappings":"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"}